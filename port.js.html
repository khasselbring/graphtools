<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: port.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: port.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Accessible via `require('@buggyorg/graphtools').Port`
 * 
 * Methods for handling ports. A port is attached to a node and connects data sources with sinks.
 * The port format is a unique identifier for the port and its node unlike the port name.
 * @module Port */

import curry from 'lodash/fp/curry'
import merge from 'lodash/fp/merge'
import _ from 'lodash'

const OUTPUT = 'output'
const INPUT = 'input'

/**
 * Checks whether a string represents a port notation. A port notation is a string that
 * contains the information about the node and the port separated by an `@`, e.g. 'nodeA@portB'
 * @params {string} port The string to check
 * @returns {boolean} True if the string represents a port notation, false otherwise.
 */
export function isPortNotation (port) {
  return typeof (port) === 'string' &amp;&amp; port.indexOf('@') !== -1
}

function parsePortNotation (port) {
  var split = port.split('@')
  var res = {}
  res.node = split[0]
  if (split[1] === '') {
    throw new Error('Invalid port notation. Port notation does not contain a port. Parsed port: ' + port)
  } else {
    res.port = split[1]
  }
  return res
}

/**
 * Returns a normalized port object in the form `{node: &lt;node-id>, port: &lt;port-name>}`
 * @param port The port object in any digestable form.
 * @returns {Port} A port object.
 */
export function normalize (port) {
  if (isPortNotation(port)) {
    return assureType(parsePortNotation(port))
  } else {
    if (isPortNotation(port.port)) {
      return assureType(merge(port, {port: parsePortNotation(port.port).port}))
    }
    return assureType(port)
  }
}

function assureType (port) {
  if (!port.type) {
    return _.merge({type: 'generic'}, port)
  }
  return port
}

/**
 * Returns the node stored in the port
 * @param {Port} port The port in any form.
 * @returns {NodeID} The node of the port.
 */
export function node (port) {
  return normalize(port).node
}

/**
 * Returns the port name stored for the port.
 * @param {Port} port The port in any form.
 * @returns {string} The name of the port.
 */
export function portName (port) {
  return normalize(port).port
}

/**
 * Returns the data type of the port.
 * @param {Port} port The port
 * @returns The type of the port.
 */
export function type (port) {
  return normalize(port).type
}

/**
 * Sets the type of a port and returns a new port with this updated port.
 * @param type The type to set.
 * @param {Port} port The port
 * @returns The updated port.
 */
export function setType (type, port) {
  return merge(port, {type})
}

/**
 * Returns the kind of the port. Either output or input.
 * @param {Port} port The port
 * @returns The kind of the port. It is either 'input' or 'output'.
 */
export function kind (port) {
  return normalize(port).kind
}

/**
 * Returns whether the given port is an output port or not
 * @param {Port} port The port to check
 * @returns {boolean} True if the port is an output port, false otherwise.
 */
export function isOutputPort (port) {
  return port.kind === OUTPUT
}

/**
 * Returns whether the given port is an input port or not
 * @param {Port} port The port to check
 * @returns {boolean} True if the port is an input port, false otherwise.
 */
export function isInputPort (port) {
  return port.kind === INPUT
}

/**
 * Returns whether the given object is a port object or not.
 * @params any Any value.
 * @returns {boolean} True if the value is a port, false otherwise.
 */
export function isPort (any) {
  return (typeof (any) === 'object' &amp;&amp; typeof (any.node) === 'string' &amp;&amp; typeof (any.port) === 'string') ||
    typeof (any) === 'string' &amp;&amp; isPortNotation(any)
}

/**
 * Returns whether the given port is valid or not.
 * @param port The object to test.
 * @returns {boolean} True if the value is a valid port, false otherwise.
 */
export function isValid (port) {
  return typeof (port) === 'object' &amp;&amp; port.port &amp;&amp; (port.kind === INPUT || port.kind === OUTPUT) &amp;&amp; port.type
}

/**
 * Asserts that the given port is valid.
 * @param port The object to test.
 * @throws {Error} Error if the object is not a valid port.
 */
export function assertValid (port) {
  if (typeof (port) !== 'object') {
    throw new Error('Port is not an object, but is ' + port)
  }
  if (!port.port) {
    throw new Error('Port does not have a `port` prop')
  }
  if (!port.type) {
    throw new Error('Port does not have a `type` prop')
  }
  if (port.kind !== INPUT &amp;&amp; port.kind !== OUTPUT) {
    throw new Error('Port `kind` prop should be "input" or "output", but was ' + port.kind)
  }
}

/**
 * Returns a string representation of the port
 * @params {Port} port The port
 * @returns {string} A string representation of the port.
 */
export function toString (port) {
  return node(port) + '@' + portName(port)
}

/**
 * @function
 * @name equal
 * @description Determines if two ports are equal
 * @param {Port} port1 One of the ports.
 * @param {Port} port2 The other port..
 * @returns {boolean} True if the ports are equal, false otherwise.
 */
export const equal = curry((port1, port2) => {
  return node(port1) === node(port2) &amp;&amp; isomorph(port1, port2)
})

export const isomorph = curry((port1, port2) => {
  return portName(port1) === portName(port2) &amp;&amp; (type(port1) === type(port2))
})

/**
 * @function
 * @name create
 * @description Create a new port object.
 * @param {Node|String} node A node object or the id of a valid node.
 * @param {String} port The name of the port
 * @param {String} kind 'input' or 'output'
 * @returns {Port} A valid port object.
 */
export const create = curry((node, port, kind, type = 'generic') => {
  if (typeof (node) === 'object') {
    return normalize({node: node.id, port, kind, type})
  } else {
    return normalize({node, port, kind, type})
  }
})

/**
 * @function
 * @name port
 * @description Create a proto port object that can be used as a location. It is no
 * valid port.
 * @param {Node|String} node A node object or the id of a valid node.
 * @param {String} port The name of the port
 * @returns {Port} A valid port object.
 */
export const port = curry((node, port) => {
  if (typeof (node) === 'object') {
    return normalize({node: node.id, port})
  } else {
    return normalize({node, port})
  }
})
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Algorithm.html">Algorithm</a></li><li><a href="module-Component.html">Component</a></li><li><a href="module-CompoundPath.html">CompoundPath</a></li><li><a href="module-Edge.html">Edge</a></li><li><a href="module-Node.html">Node</a></li><li><a href="module-Port.html">Port</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addComponent">addComponent</a></li><li><a href="global.html#addEdge">addEdge</a></li><li><a href="global.html#addNode">addNode</a></li><li><a href="global.html#addNodeByPath">addNodeByPath</a></li><li><a href="global.html#addNodeIn">addNodeIn</a></li><li><a href="global.html#addNodeTuple">addNodeTuple</a></li><li><a href="global.html#applyChangeSet">applyChangeSet</a></li><li><a href="global.html#applyChangeSetInplace">applyChangeSetInplace</a></li><li><a href="global.html#applyChangeSets">applyChangeSets</a></li><li><a href="global.html#areConnected">areConnected</a></li><li><a href="global.html#atomics">atomics</a></li><li><a href="global.html#blocked">blocked</a></li><li><a href="global.html#childrenOf">childrenOf</a></li><li><a href="global.html#clone">clone</a></li><li><a href="global.html#component">component</a></li><li><a href="global.html#componentIds">componentIds</a></li><li><a href="global.html#components">components</a></li><li><a href="global.html#compound">compound</a></li><li><a href="global.html#compoundify">compoundify</a></li><li><a href="global.html#compounds">compounds</a></li><li><a href="global.html#convertToLambda">convertToLambda</a></li><li><a href="global.html#createConnection">createConnection</a></li><li><a href="global.html#criticalNodes">criticalNodes</a></li><li><a href="global.html#distribute">distribute</a></li><li><a href="global.html#distributeSequential">distributeSequential</a></li><li><a href="global.html#distributeWith">distributeWith</a></li><li><a href="global.html#edge">edge</a></li><li><a href="global.html#edges">edges</a></li><li><a href="global.html#edgesDeep">edgesDeep</a></li><li><a href="global.html#empty">empty</a></li><li><a href="global.html#excludeNode">excludeNode</a></li><li><a href="global.html#flow">flow</a></li><li><a href="global.html#flowCallback">flowCallback</a></li><li><a href="global.html#fromFile">fromFile</a></li><li><a href="global.html#fromJSON">fromJSON</a></li><li><a href="global.html#fromString">fromString</a></li><li><a href="global.html#get">get</a></li><li><a href="global.html#getMetaKey">getMetaKey</a></li><li><a href="global.html#getNodeMetaKey">getNodeMetaKey</a></li><li><a href="global.html#hasComponent">hasComponent</a></li><li><a href="global.html#hasEdge">hasEdge</a></li><li><a href="global.html#hasNode">hasNode</a></li><li><a href="global.html#identifies">identifies</a></li><li><a href="global.html#idToPath">idToPath</a></li><li><a href="global.html#incidents">incidents</a></li><li><a href="global.html#includePredecessor">includePredecessor</a></li><li><a href="global.html#inIncident">inIncident</a></li><li><a href="global.html#inIncidents">inIncidents</a></li><li><a href="global.html#insertComponent">insertComponent</a></li><li><a href="global.html#insertEdge">insertEdge</a></li><li><a href="global.html#insertNode">insertNode</a></li><li><a href="global.html#isChangeSet">isChangeSet</a></li><li><a href="global.html#isFrom">isFrom</a></li><li><a href="global.html#isomorph">isomorph</a></li><li><a href="global.html#isPortNotation">isPortNotation</a></li><li><a href="global.html#Let">Let</a></li><li><a href="global.html#location">location</a></li><li><a href="global.html#lowestCommonAncestors">lowestCommonAncestors</a></li><li><a href="global.html#mergeNodes">mergeNodes</a></li><li><a href="global.html#meta">meta</a></li><li><a href="global.html#namedFlow">namedFlow</a></li><li><a href="global.html#node">node</a></li><li><a href="global.html#nodeBy">nodeBy</a></li><li><a href="global.html#nodeByPath">nodeByPath</a></li><li><a href="global.html#nodeNames">nodeNames</a></li><li><a href="global.html#nodes">nodes</a></li><li><a href="global.html#nodesBy">nodesBy</a></li><li><a href="global.html#nodesDeep">nodesDeep</a></li><li><a href="global.html#nodesDeepBy">nodesDeepBy</a></li><li><a href="global.html#outIncidents">outIncidents</a></li><li><a href="global.html#parent">parent</a></li><li><a href="global.html#parseCompoundPath">parseCompoundPath</a></li><li><a href="global.html#pointsTo">pointsTo</a></li><li><a href="global.html#port">port</a></li><li><a href="global.html#predecessor">predecessor</a></li><li><a href="global.html#predecessors">predecessors</a></li><li><a href="global.html#predecessorsUntil">predecessorsUntil</a></li><li><a href="global.html#predecessorsUpTo">predecessorsUpTo</a></li><li><a href="global.html#query">query</a></li><li><a href="global.html#realizeEdgesForNode">realizeEdgesForNode</a></li><li><a href="global.html#references">references</a></li><li><a href="global.html#removeComponent">removeComponent</a></li><li><a href="global.html#removeEdge">removeEdge</a></li><li><a href="global.html#removeMetaKey">removeMetaKey</a></li><li><a href="global.html#removeNode">removeNode</a></li><li><a href="global.html#removeNodeMetaKey">removeNodeMetaKey</a></li><li><a href="global.html#rePath">rePath</a></li><li><a href="global.html#replaceByCall">replaceByCall</a></li><li><a href="global.html#replaceByThunk">replaceByThunk</a></li><li><a href="global.html#replaceNode">replaceNode</a></li><li><a href="global.html#replacePort">replacePort</a></li><li><a href="global.html#sameParents">sameParents</a></li><li><a href="global.html#sameParentsNodes">sameParentsNodes</a></li><li><a href="global.html#sequential">sequential</a></li><li><a href="global.html#set">set</a></li><li><a href="global.html#setMeta">setMeta</a></li><li><a href="global.html#setMetaKey">setMetaKey</a></li><li><a href="global.html#setNodeMeta">setNodeMeta</a></li><li><a href="global.html#setNodeMetaKey">setNodeMetaKey</a></li><li><a href="global.html#setPortName">setPortName</a></li><li><a href="global.html#successors">successors</a></li><li><a href="global.html#toJSON">toJSON</a></li><li><a href="global.html#unCompound">unCompound</a></li><li><a href="global.html#updateComponent">updateComponent</a></li><li><a href="global.html#updateEdge">updateEdge</a></li><li><a href="global.html#updateMetaKey">updateMetaKey</a></li><li><a href="global.html#updateNode">updateNode</a></li><li><a href="global.html#updateNodeMetaKey">updateNodeMetaKey</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Thu Apr 20 2017 22:15:44 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
